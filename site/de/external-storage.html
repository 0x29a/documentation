<!DOCTYPE html>
<html lang="de">
<head>
    <title>
        


    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link type="text/css" rel="stylesheet" href="/static/css/bookwyrm.css">
    <link type="text/css" rel="stylesheet" href="/static/css/icons.css">
    <link type="text/css" rel="stylesheet" href="/static/css/bulma.min.css">

    <link rel="shortcut icon" type="image/x-icon" href="/static/images/favicon.ico">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Bookwyrm Documentation">
    <meta name="og:title" content="Bookwyrm Documentation">
    <meta name="twitter:description" content="Documentation for using and contributing to BookWyrm">
    <meta name="og:description" content="Documentation for using and contributing to BookWyrm">

    <meta name="twitter:image" content="">
    <meta name="og:image" content="">
    <meta name="twitter:image:alt" content="BookWyrm Logo">

    <meta charset="UTF-8">
</head>
<body>
<nav class="navbar container is-max-desktop" aria-label="main navigation">
    <div class="navbar-brand">
        <a class="navbar-item" href="https://joinbookwyrm.com/">
            <img class="image logo" src="/static/images/logo-small.png" alt="Go back to the homepage">
        </a>
    </div>

    <div class="navbar-menu" id="main-nav">
        <div class="navbar-start">
            <a href="https://joinbookwyrm.com/de/instances" class="navbar-item">
                <span class="button is-success">Beitreten</span>
            </a>
            <a href="https://joinbookwyrm.com/de/get-involved" class="navbar-item">
                Machen Sie mit
            </a>
            <a href="https://www.patreon.com/bookwyrm" class="navbar-item">
                Unterstützung
            </a>
            <a href="https://github.com/bookwyrm-social/bookwyrm" class="navbar-item">
                Code
            </a>
            <a href="#" class="navbar-item is-active">
                Dokumentation
            </a>
        </div>
    </div>
    <div class="navbar-end">
        <div class="navbar-item">
            <div class="select">
                <select aria-label="Select a language" id="language_selection">
                    
                    <option value="" >English (US)</option>
                    
                    <option value="de/" selected>Deutsch</option>
                    
                    <option value="pt-br/" >Português do Brasil</option>
                    
                    <option value="ro/" >Română</option>
                    
              </select>
            </div>
        </div>
    </div>
</nav>

<div class="container is-max-desktop">
<section class="section">

    <header class="content block column is-offset-one-quarter pl-2">
        
<h1 class="title is-1"></h1>

    </header>
    <div class="columns">
	<nav class="menu column is-one-quarter mt-2">
            <h2 class="menu-label"><a href="/de/">Welcome</a></h2>
            
            <h2 class="menu-label">Using BookWyrm</h2>
            <ul class="menu-list">
                
                <li>
                    <a href="/de/posting-statuses.html" >Posting statuses</a>
                </li>
                
            </ul>
            
            <h2 class="menu-label">Running BookWyrm</h2>
            <ul class="menu-list">
                
                <li>
                    <a href="/de/install-prod.html" >Installing in Production</a>
                </li>
                
                <li>
                    <a href="/de/updating.html" >Updating Your Instance</a>
                </li>
                
                <li>
                    <a href="/de/reverse-proxy.html" >Using a Reverse-Proxy</a>
                </li>
                
                <li>
                    <a href="/de/moderation.html" >Moderation</a>
                </li>
                
                <li>
                    <a href="/de/external-storage.html" class="is-active">External Storage</a>
                </li>
                
                <li>
                    <a href="/de/optional_features.html" >Optional features</a>
                </li>
                
                <li>
                    <a href="/de/cli.html" >Command Line Tool</a>
                </li>
                
            </ul>
            
            <h2 class="menu-label">Contributing</h2>
            <ul class="menu-list">
                
                <li>
                    <a href="/de/contributing.html" >How to Contribute</a>
                </li>
                
                <li>
                    <a href="/de/translation.html" >Translations</a>
                </li>
                
                <li>
                    <a href="/de/install-dev.html" >Developer Environment</a>
                </li>
                
                <li>
                    <a href="/de/style_guide.html" >Style Guide</a>
                </li>
                
                <li>
                    <a href="/de/debug_toolbar.html" >Django Debug Toolbar</a>
                </li>
                
            </ul>
            
            <h2 class="menu-label">Codebase</h2>
            <ul class="menu-list">
                
                <li>
                    <a href="/de/activitypub.html" >ActivityPub</a>
                </li>
                
                <li>
                    <a href="/de/permissions.html" >Permissions</a>
                </li>
                
            </ul>
            
        </nav>

        <div class="column">
            
<section class="block content">
    <p>Standardmäßig verwendet BookWyrm lokalen Speicher für statische Assets (Favicon, Standard-Avatar, etc.) und Medien (Benutzer-Avatare, Buchtitelbilder usw.), aber Sie können einen externen Speicherdienst verwenden, um diese Dateien zu bereitzustellen. BookWyrm verwendet <code>django-storages</code>, um externen Speicher wie S3-kompatible Dienste, Apache Libcloud oder SFTP anzubinden.</p>
<h2>S3-kompatibler Speicher</h2>
<h3>Einrichtung</h3>
<p>Erstellen Sie einen Bucket in Ihrem S3-kompatiblen Dienst der Wahl, zusammen mit einer Zugangsschlüssel-ID und einem geheimen Zugriffsschlüssel. Diese können selbst gehostet sein, wie <a href="https://ceph.io/en/">Ceph</a> (LGPL 2.1/3.0) oder <a href="https://min.io/">MinIO</a> (GNU AGPL v3.0) oder kommerziell (<a href="https://www.scaleway.com/en/docs/object-storage-feature/">Scaleway</a>, <a href="https://www.digitalocean.com/community/tutorials/how-to-create-a-digitalocean-space-and-api-key">Digital Ocean</a>…).</p>
<p>Diese Anleitung wurde mit Scaleway Object Storage getestet. Wenn Sie einen anderen Dienst verwenden, teilen Sie bitte Ihre Erfahrungen (insbesondere wenn Sie andere Schritte unternehmen mussten), indem Sie einen Problembericht im <a href="https://github.com/bookwyrm-social/documentation">BookWyrm Dokumentations</a>-Repository einreichen.</p>
<h3>Was erwartet Sie</h3>
<p>Wenn Sie eine neue BookWyrm-Instanz starten, wird der Prozess sein:</p>
<ul>
<li>Richten Sie Ihren externen Speicherservice ein</li>
<li>Aktiviere externen Speicher auf BookWyrm</li>
<li>Starten Sie Ihre BookWyrm-Instanz</li>
<li>Instanz Konnektor aktualisieren</li>
</ul>
<p>Wenn Sie Ihre Instanz bereits gestartet haben und Bilder auf den lokalen Speicher hochgeladen wurden, wird der Prozess sein:</p>
<ul>
<li>Richten Sie Ihren externen Speicherdienst ein</li>
<li>Kopieren Sie Ihre lokalen Medien auf externen Speicher</li>
<li>Aktiviere externen Speicher auf BookWyrm</li>
<li>Starten Sie Ihre BookWyrm-Instanz neu</li>
<li>Instanz-Konnektor aktualisieren</li>
</ul>
<h3>BookWyrm-Einstellungen</h3>
<p>Bearbeiten Sie Ihre <code>.env</code>-Datei, indem Sie die folgenden Zeilen auskommentieren:</p>
<ul>
<li><code>AWS_ACCESS_KEY_ID</code>: Ihre Zugangsschlüssel-ID</li>
<li><code>AWS_SECRET_ACCESS_KEY</code>: Ihr geheimer Zugangsschlüssel</li>
<li><code>AWS_STORAGE_BUCKET_NAME</code>: Ihr Bucket Name</li>
<li><code>AWS_S3_REGION_NAME</code>: z.B. <code>"eu-west-1"</code> für AWS, <code>"fr-par"</code> für Scaleway oder <code>"nyc3"</code> für Digital Ocean</li>
</ul>
<p>Wenn Ihr S3-kompatibler Dienst Amazon AWS ist, sollten Sie startklar sein. Wenn nicht, müssen Sie die folgenden Zeilen wieder kommentieren:</p>
<ul>
<li><code>AWS_S3_CUSTOM_DOMAIN</code>: die Domain, die die Assets bereitstellen soll, z.B. <code>"example-bucket-name.s3.fr-par.scw.cloud"</code> oder <code>"${AWS_STORAGE_BUCKET_NAME}.${AWS_S3_REGION_NAME}.digitaloceanspaces.com"</code></li>
<li><code>AWS_S3_ENDPOINT_URL</code>: der S3-API-Endpunkt, z.B. <code>"https://s3.fr-par.scw.cloud"</code> oder <code>"https://${AWS_S3_REGION_NAME}.digitaloceanspaces.com"</code></li>
</ul>
<h3>Kopieren lokaler Medien auf externen Speicher</h3>
<p>Wenn Ihre BookWyrm-Instanz bereits läuft und Medien hochgeladen wurden (Benutzer-Avatare, Buchtitelbilder…), müssen Sie hochgeladene Medien in Ihren Bucket migrieren.</p>
<p>Diese Aufgabe wird mit dem Befehl erledigt:</p>
<pre><code class="language-bash">./bw-dev copy_media_to_s3
</code></pre>
<h3>Aktivierung des externen Speichers für BookWyrm</h3>
<p>To enable the S3-compatible external storage, you will have to edit your <code>.env</code> file by changing the property value for <code>USE_S3</code> from <code>false</code> to <code>true</code>:</p>
<pre><code>USE_S3=true
</code></pre>
<p>If your external storage is being served over HTTPS (which most are these days), you'll also need to make sure that <code>USE_HTTPS</code> is set to <code>true</code>, so images will be loaded over HTTPS:</p>
<pre><code>USE_HTTPS=true
</code></pre>
<h4>Statische Assets</h4>
<p>Then, you will need to run the following command, to copy the static assets to your S3 bucket:</p>
<pre><code class="language-bash">./bw-dev collectstatic
</code></pre>
<h4>CORS-Einstellungen</h4>
<p>Once the static assets are collected, you will need to set up CORS for your bucket.</p>
<p>Some services like Digital Ocean provide an interface to set it up, see <a href="https://docs.digitalocean.com/products/spaces/how-to/configure-cors/">Digital Ocean doc: How to Configure CORS</a>.</p>
<p>If your service doesn’t provide an interface, you can still set up CORS with the command line.</p>
<p>Create a file called <code>cors.json</code>, with the following content:</p>
<pre><code class="language-json">{
  &quot;CORSRules&quot;: [
    {
      &quot;AllowedOrigins&quot;: [&quot;https://MY_DOMAIN_NAME&quot;, &quot;https://www.MY_DOMAIN_NAME&quot;],
      &quot;AllowedHeaders&quot;: [&quot;*&quot;],
      &quot;AllowedMethods&quot;: [&quot;GET&quot;, &quot;HEAD&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;],
      &quot;MaxAgeSeconds&quot;: 3000,
      &quot;ExposeHeaders&quot;: [&quot;Etag&quot;]
    }
  ]
}
</code></pre>
<p>Replace <code>MY_DOMAIN_NAME</code> with the domain name(s) of your instance.</p>
<p>Then, run the following command:</p>
<pre><code class="language-bash">./bw-dev set_cors_to_s3 cors.json
</code></pre>
<p>Keine Ausgabe bedeutet, dass es gut sein sollte.</p>
<p>Wenn Sie eine neue BookWyrm-Instanz starten, können Sie sofort zu den Installationsanweisungen zurückkehren. Wenn nicht, lesen Sie weiter.</p>
<h3>Aktualisiere deine Instanz</h3>
<p>Once the media migration has been done and the static assets are collected, you can load the new <code>.env</code> configuration and restart your instance with:</p>
<pre><code class="language-bash">./bw-dev up -d
</code></pre>
<p>If all goes well, your storage has been changed without server downtime. If some fonts are missing (and your browser’s JS console lights up with alerts about CORS), something went wrong <a href="#cors-settings">here</a>. In that case it might be good to check the headers of a HTTP request against a file on your bucket:</p>
<pre><code class="language-bash">curl -X OPTIONS -H 'Origin: http://MY_DOMAIN_NAME' http://BUCKET_URL/static/images/logo-small.png -H &quot;Access-Control-Request-Method: GET&quot;
</code></pre>
<p>Replace <code>MY_DOMAIN_NAME</code> with your instance domain name, <code>BUCKET_URL</code> with the URL for your bucket, you can replace the file path with any other valid path on your bucket.</p>
<p>If you see any message, especially a message starting with <code>&lt;Error&gt;&lt;Code&gt;CORSForbidden&lt;/Code&gt;</code>, it didn’t work. Wenn Sie keine Nachricht sehen, funktionierte es.</p>
<p>For an active instance, there may be a handful of files that were created locally during the time between migrating the files to external storage, and restarting the app so it uses the external storage. To ensure that any remaining files are uploaded to external storage after switching over, you can use the following command, which will upload only files that aren't already present in the external storage:</p>
<pre><code class="language-bash">./bw-dev sync_media_to_s3
</code></pre>
<h3>Instanz-Konnektor aktualisieren</h3>
<p><em>Note: You can skip this step if you're running an updated version of BookWyrm; in September 2021 the "self connector" was removed in <a href="https://github.com/bookwyrm-social/bookwyrm/pull/1413">PR #1413</a></em></p>
<p>In order for the right URL to be used when displaying local book search results, we have to modify the value for the cover images URL base.</p>
<p>Connector data can be accessed through the Django admin interface, located at the url <code>http://MY_DOMAIN_NAME/admin</code>. The connector for your own instance is the first record in the database, so you can access the connector with this URL: <code>https://MY_DOMAIN_NAME/admin/bookwyrm/connector/1/change/</code>.</p>
<p>The field <em>Covers url</em> is defined by default as <code>https://MY_DOMAIN_NAME/images</code>, you have to change it to <code>https://S3_STORAGE_URL/images</code>. Then, click the <em>Save</em> button, and voilà!</p>
<p>You will have to update the value for <em>Covers url</em> every time you change the URL for your storage.</p>
</section>

        </div>
    </div>
</section>
</div>

<footer id="contentinfo" class="footer">
    <div class="container is-max-desktop">
        <div class="columns">
            <div class="column content">
                <p>
                    <strong>BookWyrm</strong> ist eine kollaborative, nichtkommerzielle Software, die von <a href='https://www.mousereeve.com/'>Mouse Reeve</a> betreut wird.
                </p>
                <p>
                    Unterstütze BookWyrm auf <a href='https://www.patreon.com/bookwyrm' target='_blank'>Patreon</a>.
                </p>
            </div>
            <div class="column">
                <h3 class="title is-6">Machen Sie mit</h3>
                <p>
                    <a href="https://github.com/bookwyrm-social">BookWyrm auf GitHub</a>
                </p>
                <p>
                    <a href="https://github.com/bookwyrm-social/join-bookwyrm">Zu dieser Seite beitragen</a>
                </p>
                <p>
                    <a href="https://twitter.com/BookWyrmSocial" target="_blank">
                        <span class="icon icon-twitter"><span class="is-sr-only">Twitter</span></span>
                    </a>
                    <a href="https://tech.lgbt/@bookwyrm" target="_blank" rel="me">
                        <span class="icon icon-mastodon"><span class="is-sr-only">Mastodon</span></span>
                    </a>
                    <a href="https://www.patreon.com/bookwyrm" target="_blank">
                        <span class="icon icon-patreon"><span class="is-sr-only">Patreon</span></span>
                    </a>
                </p>
            </div>
            <div class="column">
                <h3 class="title is-6">Mehr</h3>
                <p>
                    <a href="https://docs.joinbookwyrm.com">Dokumentation</a>
                </p>
                <p>
                    <a href="mailto:mousereeve@riseup.net">Kontaktieren Sie die Entwickler</a>
                </p>
                <p>
                    <a href="https://raw.githubusercontent.com/bookwyrm-social/join-bookwyrm/main/LICENSE.md">Lizenz</a>
                </p>
            </div>
        </div>
    </div>
</footer>

<script type="text/javascript">
    (function() {
        var languageSelector = document.getElementById("language_selection");
        languageSelector.onchange = function(event) {
            var current_locale = "de/";
            var current_location = window.location.pathname;

            var locale_index = current_location.indexOf(current_locale);
            var new_location = "/" + event.target.value;

            if (locale_index) {
                new_location += current_location.slice(locale_index + current_locale.length);
            } else {
                new_location += current_location.slice(1);
            }

            window.location = new_location;
        }
    })()
</script>

</body>
</html>